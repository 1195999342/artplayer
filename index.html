<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <title>视频播放</title>
    <meta name="referrer" content="no-referrer">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            margin: 0;
            padding: 0;
            background: black;
            height: 100%;
        }
        .artplayer-app {
            width: 100%;
            height: 100vh;
        }
    </style>

    <script src="artplayer/js/artplayer.js"></script>
    <script src="artplayer/js/hls.min.js"></script>

</head>
<body>

<div class="artplayer-app"></div>

<script>
    // 读取 URL 参数
    function getQuery(key) {
        const query = new URLSearchParams(window.location.search);
        return query.get(key);
    }

    let videoUrl = getQuery("url");

    if (!videoUrl) {
        document.body.innerHTML = '<h3 style="color:greenyellow;text-align:center;margin-top:40vh;">播放地址为空</h3>';
        throw new Error("播放地址为空");
    }

    const art = new Artplayer({
        container: '.artplayer-app',
        url: videoUrl,
        autoplay: true,
        playsInline: true,
        fullscreen: true,
        pip: true,
        theme: '#23ade5',
        fastForward: true,
        lock: true,
        //autoSize: true,
        airplay: true,
        //fullscreenWeb: true,
        autoOrientation: true,
        autoMini: true,
        flip: true,
        playbackRate: true,
        aspectRatio: true,
        screenshot: true,
        hotkey: true,
        setting: true,
        customType: {
            m3u8: function (video, url, art) {
                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(video);
                    art.on('destroy', () => hls.destroy());
                } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = url;
                } else {
                    art.notice.show = '该浏览器不支持 m3u8 播放';
                }
            },
        },
    });

</script>

</body>
</html>
